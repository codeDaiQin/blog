---
title: ä¸ä¸€æ ·çš„å·¥å…·ç±»
date: '2022-07-06'
tags: ['TypeScript']
draft: false
summary: TypeScript å…¨é¢è¿›é˜¶æŒ‡å—
---

# TypeScript ç±»å‹å·¥å…· ğŸ”§

> `ç±»å‹åˆ«å type + æ³›å‹ <T> => å·¥å…·ç±»`

## å·¥å…·ç±»

### å¸¸è§å·¥å…·ç±»

```ts
// keyof any => string | number | symbol
// å› ä¸ºkeyåªèƒ½ä¸ºä»¥ä¸Šç±»å‹
type Record<K extends keyof any, T> = { [P in K]: T }

// ä»Tç±»å‹ä¸­æ’é™¤U è¿”å› å‰©ä½™çš„Key
type Exclude<T, U> = T extends U ? never : T

// ä»Tç±»å‹ä¸­ é€‰å– K
type Pick<T, K extends keyof T> = { [P in K]: T[P] }

// ä»Tç±»å‹ä¸­ æ’é™¤ K å­—æ®µ
type Omit<T, K extends keyof any> = Pick<T, Exclude<keyof T, K>>
```

## æ“ä½œç¬¦

### keyof

```ts
type Cat = {
  name: string
  age: number
}

// => 'name' | 'age' è”åˆç±»å‹
type Keys = keyof Cat
```

### typeof

```ts
const foo = {
  name: 'mmc',
  age: 17,
}
// => { name: string, age: number }
type Bar = typeof foo
```

### in å…³é”®å­—

```ts
// ä¼šéå†è¿™ä¸ª keyof Tè¿”å›çš„è”åˆç±»å‹
type Readonly<T> = {
  readonly [P in keyof T]: T[P]
}

interface Foo {
  prop1: string
  prop2: number
  prop3: boolean
  prop4: () => void
}

type TestReadonly1 = Readonly<Foo>

// ç­‰ä»·äº
interface TestReadonly2 {
  readonly prop1: string
  readonly prop2: number
  readonly prop3: boolean
  readonly prop4: () => void
}

// ç”¨ä¼ªä»£ç è¡¨ç¤º
const Foo = {}
for (const K of Object.keys(T)) {
  Foo[K] = readonly T[K]
}
```

### is å…³é”®å­—

> is å…³é”®å­— + é¢„æœŸç±»å‹

ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ° is

å…ˆçœ‹è¿™ä¸ªä¾‹å­

```ts
function isString(value: unknown): boolean {
  return typeof value === 'string'
}

function foo(value: string | number) {
  if (isString(value)) {
    // ç±»å‹â€œstring | numberâ€ä¸Šä¸å­˜åœ¨å±æ€§â€œreplaceâ€ã€‚
    value.replace('mmc', 'huige666')
    // å› ä¸º isStringå‡½æ•°ä¸åœ¨fooä¸­ï¼Œç±»å‹åˆ†æåšä¸åˆ°è·¨å‡½æ•°ä¸Šä¸‹ä¿¡æ¯æ”¶é›†
  }
  if (typeof value === 'number') {
    // ...
  }
}
```

ä¸ºäº†è§£å†³è¿™ä¸€ç±»å‹æ§åˆ¶æµåˆ†æçš„èƒ½åŠ›ä¸è¶³, TypeScript å¼•å…¥äº† is å…³é”®å­—æ¥æ˜¾å¼åœ°æä¾›ç±»å‹ä¿¡æ¯

```ts
const isNumber = (value: unkown): value is number => {
  // å¦‚æœ return true å³ä¸º é¢„æœŸç±»å‹
  return typeof value === 'number'
}
```

## ç´¢å¼•ç±»å‹è®¿é—®

```ts
interface StringMap {
  name: string
}
type String = StringMap['name'] // => string
```
